#!/bin/sh
# Husky pre-commit hook - Run all quality checks before commit

echo "ğŸ” Running pre-commit checks..."

# 1. Format check
echo "\nğŸ“ Checking code formatting..."
pnpm format:check > /dev/null 2>&1 || {
  echo "âŒ Formatting check failed. Run 'pnpm format' to fix."
  exit 1
}
echo "âœ… Formatting passed"

# 2. Lint
echo "\nğŸ”§ Running ESLint..."
pnpm lint > /dev/null 2>&1 || {
  echo "âŒ Linting failed. Fix errors or run 'pnpm lint:fix'."
  exit 1
}
echo "âœ… Linting passed"

# 3. Type check
echo "\nğŸ” Running TypeScript type check..."
pnpm type-check > /dev/null 2>&1 || {
  echo "âŒ Type checking failed. Fix TypeScript errors."
  exit 1
}
echo "âœ… Type checking passed"

# 4. Run tests with coverage
echo "\nğŸ§ª Running tests with coverage (this may take a minute)..."
pnpm coverage:all > /dev/null 2>&1 || {
  echo "âŒ Tests or coverage check failed. Run 'pnpm coverage:all' to see details."
  exit 1
}
echo "âœ… Tests and coverage passed"

echo "\nâœ… All pre-commit checks passed!"
